Feature: 예약 생성
  고객은 캠핑장 예약을 위해 원하는 날짜와 사이트를 지정하고, 개인 정보를 입력하여 예약을 생성할 수 있다.
  시스템은 예약 규칙(기간 제한, 중복 방지 등)을 검증해야 한다.

  Scenario: [성공] 사용자가 유효한 정보로 예약을 성공적으로 생성한다
    Given 예약 가능한 캠핑 사이트와 날짜가 있다
    When 사용자가 유효한 이름, 전화번호, 그리고 30일 이내의 유효한 기간으로 예약을 요청하면
    Then 예약은 성공적으로 완료되고, 고유한 확인 코드를 받는다.

  Scenario: [실패] 사용자가 31일 이후의 날짜로 예약을 시도한다
    Given 사용자가 예약을 시도한다
    When 31일을 초과하는 미래의 날짜로 예약을 요청하면
    Then "예약은 31일 이내만 가능합니다."라는 오류 메시지와 함께 예약이 실패한다.

  Scenario: [실패] 사용자가 과거 날짜로 예약을 시도한다
    Given 사용자가 예약을 시도한다
    When 과거 날짜를 포함하여 예약을 요청하면
    Then "과거 날짜는 예약할 수 없습니다."라는 오류 메시지와 함께 예약이 실패한다.

  Scenario: [실패] 필수 정보(이름)를 누락하여 예약을 시도한다
    Given 사용자가 예약을 시도한다
    When 이름을 입력하지 않고 예약을 요청하면
    Then "필수 정보가 누락되었습니다."라는 오류 메시지와 함께 예약이 실패한다.

  Scenario: [실패] 이미 예약된 날짜에 중복 예약을 시도한다
    Given 'A-101' 사이트의 '2025-10-10' 날짜는 이미 예약되어 있다
    When 다른 사용자가 'A-101' 사이트의 '2025-10-10' 날짜를 포함하여 예약을 요청하면
    Then "해당 날짜는 이미 예약이 마감되었습니다."라는 오류 메시지와 함께 예약이 실패한다.

Feature: 가용성 확인
  고객은 특정 기간 동안 예약이 가능한 사이트를 조회하여 예약 계획을 세울 수 있다.
  연박의 경우, 전체 기간 동안 예약이 가능해야만 사이트가 조회되어야 한다.

  Scenario: [성공] 사용자가 조회한 기간에 예약 가능한 사이트가 있다
    Given '2025-10-15'부터 '2025-10-17'까지 'B-201' 사이트는 예약이 비어있다
    When 사용자가 '2025-10-15'부터 '2025-10-17'까지의 가용성을 검색하면
    Then 조회 결과에 'B-201' 사이트가 포함되어야 한다.

  Scenario: [실패] 연박 기간 중 일부 날짜가 예약 불가능하다
    Given 'C-301' 사이트는 '2025-11-01'에 예약이 가능하지만, '2025-11-02'에는 이미 예약되어 있다
    When 사용자가 '2025-11-01'부터 '2025-11-03'까지의 가용성을 검색하면
    Then 조회 결과에 'C-301' 사이트가 포함되지 않아야 한다.

  Scenario: [정보] 조회한 기간에 예약 가능한 사이트가 하나도 없다
    Given '2025-12-24'부터 '2025-12-25'까지 모든 사이트가 예약 마감되었다
    When 사용자가 해당 기간의 가용성을 검색하면
    Then "해당 기간에 예약 가능한 사이트가 없습니다."라는 메시지가 표시되어야 한다.

Feature: 동시성 제어
  여러 사용자가 동일한 자원(사이트, 날짜)에 동시에 예약을 시도할 때, 데이터 정합성을 보장하고 중복 예약을 방지한다.

  Scenario: [경합] 두 명의 사용자가 동일한 사이트와 날짜를 동시에 예약한다
    Given 'D-401' 사이트의 '2025-09-20' 날짜는 예약 가능하다
    When 사용자 A와 사용자 B가 거의 동시에 'D-401' 사이트의 '2025-09-20' 날짜 예약을 요청하면
    Then 오직 한 명의 사용자(A 또는 B)만 예약에 성공해야 한다
    And 예약에 실패한 다른 사용자는 "이미 예약이 완료되었거나 진행 중인 예약입니다."라는 메시지를 받는다.